# Pressed-Piano-Key-Detection
Master's Thesis

The goal of this thesis is to detect the pressed piano keys by analyzing the piano playerâ€™s fingers using two cameras located above and in front of the piano. Key aspect of this thesis is to figure out relevant features which can be used to determine key presses and devise an algorithm which utilizes these features. First, the hand was segmented from the background using color spaces, leaving only the area of the hand in the footage. On the segmented image the areas of the hand were used to find the convex hull of the hands and convexity defects were used to detect fingertips along with a local extrema-based method. Since there are 2 different footages of the same scene it was required to match the corresponding fingertips. To solve this problem keys on the piano were detected and labeled with different methods for both videos. After finding which fingertip is on which key, matching the fingertips with the corresponding fingertip on the other video was trivial. After this step, comparing the calculated world coordinates based on the known setup between the two cameras helped in understanding which keys are pressed at a time. Because of the angled recording of the front camera, whenever a fingertip presses a white key depth of that fingertip was higher than the upper cameras calculation which was real depth in world coordinates. Comparing these two it was seen that when the player presses a key this gap was increasing significantly. Therefore, putting a threshold on this gap to detect the pressed white key solved the problem. The black keys cast a shadow on the upper part of the piano while remaining dormant and this shadow is not visible when the key is pressed, so a dormant state mask was applied on each instance of the upper camera to reveal the black keys that are being pressed at each moment.

Example visual and audio output:

https://user-images.githubusercontent.com/40006842/152411164-ad8f58d7-15e9-43f4-94f2-c73f1070fc70.mp4

